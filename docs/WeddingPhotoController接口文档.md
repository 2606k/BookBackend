# WeddingPhotoController 接口文档

## 概述
WeddingPhotoController是婚纱照片管理控制器，负责处理照片的上传、查询和删除功能。使用MinIO进行文件存储。

**基础路径**: `/wedding/photo`

## 接口列表

### 1. 上传照片
- **接口**: `POST /wedding/photo/upload`
- **功能**: 上传照片到MinIO存储服务
- **请求参数**:
  - `file`: 上传的文件（MultipartFile）
  - `storyId`: 故事ID（可选，用于关联特定故事）
- **请求类型**: `multipart/form-data`
- **响应结果**:
```json
{
  "code": 200,
  "msg": "成功",
  "data": {
    "id": "照片ID",
    "storyId": "关联故事ID",
    "url": "照片访问URL",
    "remark": "原文件名"
  }
}
```

### 2. 查询所有照片
- **接口**: `GET /wedding/photo/list`
- **功能**: 获取所有照片列表
- **请求参数**: 无
- **响应结果**:
```json
{
  "code": 200,
  "msg": "成功",
  "data": [
    {
      "id": "照片ID",
      "storyId": "关联故事ID",
      "url": "照片访问URL",
      "remark": "备注信息",
      "createdAt": "创建时间"
    }
  ]
}
```

### 3. 按故事ID查询照片
- **接口**: `GET /wedding/photo/story/{storyId}`
- **功能**: 获取特定故事下的所有照片
- **请求参数**:
  - `storyId`: 故事ID（路径参数）
- **响应结果**:
```json
{
  "code": 200,
  "msg": "成功",
  "data": [
    {
      "id": "照片ID",
      "storyId": "故事ID",
      "url": "照片访问URL",
      "remark": "备注信息",
      "createdAt": "创建时间"
    }
  ]
}
```

### 4. 删除照片
- **接口**: `DELETE /wedding/photo/{id}`
- **功能**: 删除指定的照片记录
- **请求参数**:
  - `id`: 照片ID（路径参数）
- **响应结果**:
```json
{
  "code": 200,
  "msg": "成功",
  "data": null
}
```

## 文件上传说明
1. **支持的文件类型**: 根据MinIO配置，通常支持jpg、jpeg、png、gif等图片格式
2. **文件大小限制**: 根据系统配置和MinIO设置
3. **文件命名**: 系统会自动处理文件命名，避免冲突
4. **存储位置**: 文件存储在MinIO服务器，返回可访问的URL

## 业务逻辑
1. **文件验证**: 上传前会检查文件是否为空
2. **自动关联**: 可以通过storyId将照片关联到特定故事
3. **URL生成**: 上传成功后返回MinIO生成的访问URL
4. **备注信息**: 默认使用原文件名作为备注

## 存储架构
- **MinIO服务**: 用于文件对象存储
- **数据库记录**: 存储照片的元数据信息
- **URL访问**: 通过MinIO提供的URL直接访问照片

## 错误处理
所有接口在出现错误时返回统一格式：
```json
{
  "code": 500,
  "msg": "错误描述",
  "data": null
}
```

## 常见错误
- `上传文件为空`: 未选择文件或文件内容为空
- `文件格式不支持`: 上传了不支持的文件类型
- `存储服务异常`: MinIO服务不可用或配置错误
- `照片不存在`: 要删除的照片ID不存在

## 注意事项
1. 上传文件大小受服务器和MinIO配置限制
2. 删除照片只会删除数据库记录，MinIO中的文件需要单独清理
3. 照片URL的有效性依赖于MinIO服务的可用性
4. 建议在前端进行文件类型和大小的预检查
5. 对于敏感照片，建议增加访问权限控制
